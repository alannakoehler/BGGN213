---
title: "Class 6 Homework"
author: "Alanna Koehler"
date: "10/23/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
##Creating a function to plot protein-drug interactions

Load Bio3D
```{r}
library(bio3d)
```

Write a function pdbfiles() that will read and trim a PDB file (x) and output a limited list containing the Atom column andn the B column. 
```{r}
pdbfiles <- function(x) {
  trimmed <- trim.pdb(read.pdb(x), chain="A", elety="CA") 
  trimmed$atom$b
}
```

Next, write a function multi_plotb3() with arguments for the input list (x) generated by the pdbfiles() function, legend names (leg_names), and main title (main_title). This function will use plotb3() to plot only the first output of list x.


multi_plotb3 <- function(x, n, leg_names, main_title) {
  plotb3(x[[1]], sse=x[[1]], top = FALSE, typ="l", ylab="Bfactor")
  for(i in 2:n) {
    points(x[[i]], typ="l", ylab="Bfactor", col= c("black", "red", "blue", "green")[[i]])
    legend("topright", legend=leg_names, fill = c("black", "red", "blue", "green"), bty = "n")
    title(main = main_title)
  }
}

files = c("1AKE", "4AKE", "1E4Y")
multi_plotb3(lapply(files, plot_pdb), n = 3, leg_names=c("no drug", "drug A", "drug B"), main_title="Protein-Drug Interactions")
